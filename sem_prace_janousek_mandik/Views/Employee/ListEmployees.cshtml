@model List<sem_prace_janousek_mandik.Models.Employee.Zamestnanci_Adresy_Pozice>
@using sem_prace_janousek_mandik.Controllers.Employee;
@using sem_prace_janousek_mandik.Controllers.Management;
@using sem_prace_janousek_mandik.Models.Employee;
@section Title{
	Výpis zaměstnanců
}

@{
	Layout = "~/Views/Shared/_LayoutAll.cshtml";
}

<div class="text-center">
	<h2>Výpis všech zaměstnanců:</h2>

	@if (ViewBag.Role.Equals("Admin"))
	{
		<a asp-controller="@nameof(sem_prace_janousek_mandik.Controllers.Employee)" asp-action="@nameof(EmployeeController.AddEmployee)"><button type="submit">Přidat zaměstnance</button></a>
		<br />
		<br />
	}

	<table border="1">
		<tr>
			<td>Jméno</td>
			<td>Příjmení</td>
			<td>Heslo</td>
			<td>Datum narození</td>
			<td>Telefon</td>
			<td>Email</td>
			<td>Ulice</td>
			<td>Město</td>
			<td>Okres</td>
			<td>Země</td>
			<td>PSČ</td>
			<td>Pozice</td>
			<td>Upravit</td>
			@if (ViewBag.Role.Equals("Admin"))
			{
				<td>Odstranit</td>
				<td>Emulace</td>
			}
		</tr>

		@{
			string hidden = "<skryté>";
		}

		@foreach (Zamestnanci_Adresy_Pozice item in Model)
		{
			<tr>
				<td>@item.Zamestnanci.Jmeno</td>
				<td>@item.Zamestnanci.Prijmeni</td>
				<td>@hidden</td>

				@if (ViewBag.Email.Equals(item.Zamestnanci.Email) && !ViewBag.Role.Equals("Admin"))
				{
					<td>@item.Zamestnanci.DatumNarozeni</td>
				}
				else if (ViewBag.Role.Equals("Admin") || ViewBag.Role.Equals("Manazer"))
				{
					<!-- Zobrazení data narození pouze adminovi nebo manažerovi -->
					<td>@item.Zamestnanci.DatumNarozeni</td>
				}
				else
				{
					<td>@hidden</td>
				}

				<td>@item.Zamestnanci.Telefon</td>
				<td>@item.Zamestnanci.Email</td>

				@if (ViewBag.Email.Equals(item.Zamestnanci.Email) && !ViewBag.Role.Equals("Admin") && !ViewBag.Role.Equals("Manazer"))
				{
					<td>@item.Adresy.Ulice</td>
					<td>@item.Adresy.Mesto</td>
					if (item.Adresy.Okres.Equals(""))
					{
						<td></td>
					}
					else
					{
						<td>@item.Adresy.Okres</td>
					}
					<td>@item.Adresy.Zeme</td>
					<td>@item.Adresy.Psc</td>
				}
				else if (ViewBag.Role.Equals("Admin") || ViewBag.Role.Equals("Manazer"))
				{
					<td>@item.Adresy.Ulice</td>
					<td>@item.Adresy.Mesto</td>
					<td>@item.Adresy.Okres</td>
					<td>@item.Adresy.Zeme</td>
					<td>@item.Adresy.Psc</td>
				}
				else
				{
					<td>@hidden</td>
					<td>@hidden</td>
					<td>@hidden</td>
					<td>@hidden</td>
					<td>@hidden</td>
				}


				<td>@item.Pozice.Nazev</td>

				@if (ViewBag.Email.Equals(item.Zamestnanci.Email) && !ViewBag.Role.Equals("Admin"))
				{
					<td>
						<form asp-controller="@nameof(sem_prace_janousek_mandik.Controllers.Employee)" asp-action="@nameof(EmployeeController.EditEmployeeGet)">
							<input type="hidden" name="index" value="@item.Zamestnanci.IdZamestnance" />
							<input type="submit" value="Upravit" class="btn btn-primary" />
						</form>
					</td>
				}
				else if (ViewBag.Role.Equals("Admin"))
				{
					<td>
						<form asp-controller="@nameof(sem_prace_janousek_mandik.Controllers.Employee)" asp-action="@nameof(EmployeeController.EditEmployeeGet)">
							<input type="hidden" name="index" value="@item.Zamestnanci.IdZamestnance" />
							<input type="submit" value="Upravit" class="btn btn-primary" />
						</form>
					</td>
					<td>
						<form asp-controller="@nameof(sem_prace_janousek_mandik.Controllers.Employee)" asp-action="@nameof(EmployeeController.DeleteEmployee)">
							<input type="hidden" name="idZamestnance" value="@item.Zamestnanci.IdZamestnance" />
							<input type="hidden" name="idAdresy" value="@item.Zamestnanci.IdAdresy" />
							<input type="submit" value="Smazat" class="btn btn-primary" />
						</form>
					</td>
					<td>
						<form asp-controller="@nameof(sem_prace_janousek_mandik.Controllers.Management)" asp-action="@nameof(ManagementController.StartEmulationEmployee)">
							<input type="hidden" name="idEmployee" value="@item.Zamestnanci.IdZamestnance" />
							<input type="submit" value="Emulovat" class="btn btn-primary" />
						</form>
					</td>
				}
				else
				{
					<td>@hidden</td>
				}
			</tr>
		}
	</table>
</div>
